<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Armin ‚Äî Digital Artist (vjvc)</title>
<meta name="description" content="Armin ‚Äî Digital artist, character designer and digital painter. Portfolio, projects and contact." />
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn&display=swap" rel="stylesheet">
<style>
/* ===========================
   Monochrome theme variables
   =========================== */
:root{
  --bg: #0b0b0c;
  --card: #0f0f10;
  --muted: #bdbdbd;
  --text: #eaeaea;
  --glass-border: rgba(255,255,255,0.06);
  --glass-sheen: rgba(255,255,255,0.03);
  --radius: 14px;
  --shadow: 0 18px 50px rgba(0,0,0,0.6);
  --taskbar-h: 64px;
  --maxw: 1100px;
  --font: 'Vazirmatn', system-ui, -apple-system, "Segoe UI", Roboto, Arial;
}

/* light theme overrides */
body.light {
  --bg: #f5f5f6;
  --card: #ffffff;
  --muted: #6a6a6a;
  --text: #111;
  --glass-border: rgba(0,0,0,0.06);
  --glass-sheen: rgba(0,0,0,0.03);
  --shadow: 0 12px 30px rgba(0,0,0,0.06);
}

/* reduce motion */
@media (prefers-reduced-motion: reduce){
  :root{ --reduced: 1; }
}

/* basics */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:var(--font);
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
  line-height:1.45;
  padding-bottom: calc(var(--taskbar-h) + 20px);
  scroll-behavior:smooth;
}

/* container */
.container{max-width:var(--maxw);margin:26px auto;padding:0 20px 48px;position:relative;z-index:5}

/* glass helper (liquid glass feel) */
.glass{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  position:relative;
  overflow:hidden;
}
.glass::before{
  content:"";
  position:absolute; inset:-40% -40% -40% -40%;
  background: radial-gradient(circle at 20% 20%, var(--glass-sheen), transparent 18%), radial-gradient(circle at 80% 80%, rgba(255,255,255,0.01), transparent 12%);
  transform-origin: center;
  z-index:0;
  opacity:0.9;
  mix-blend-mode: overlay;
  animation: glassFloat 9s linear infinite;
}
.glass > *{ position:relative; z-index:1; }
@keyframes glassFloat{
  0%{ transform: rotate(0deg) translateY(0) }
  50%{ transform: rotate(6deg) translateY(6px) scale(1.02) }
  100%{ transform: rotate(0deg) translateY(0) }
}
@media (prefers-reduced-motion: reduce){
  .glass::before{ animation:none; }
}

/* header */
.header{position:sticky;top:10px;z-index:90;display:flex;justify-content:center}
.header-inner{width:100%;max-width:var(--maxw);display:flex;justify-content:space-between;align-items:center;padding:10px 18px;gap:12px}
.brand{font-weight:800;color:var(--text);text-decoration:none;font-size:1.05rem}
.nav{display:flex;gap:12px}
.nav a{color:var(--muted);text-decoration:none;font-weight:700;padding:8px;border-radius:8px}
.nav a:hover{color:var(--text)}

/* hero */
.hero{display:flex;flex-direction:column;align-items:center;text-align:center;padding:48px 10px 28px}
.avatar{width:160px;height:160px;border-radius:999px;object-fit:cover;border:3px solid rgba(255,255,255,0.06);box-shadow:0 12px 40px rgba(0,0,0,0.5);transition:transform .35s, box-shadow .35s}
.avatar:hover{transform:translateY(-6px) scale(1.02);box-shadow:0 22px 60px rgba(0,0,0,0.6)}
.title{font-size:36px;margin-top:12px;color:var(--text);font-weight:800}
.subtitle{color:var(--muted);max-width:820px;margin-top:8px;line-height:1.6}
.cta{display:flex;gap:12px;margin-top:14px}

/* buttons */
.btn{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;font-weight:800;cursor:pointer;backdrop-filter: blur(6px);transition:transform .16s ease}
.btn:hover{transform:translateY(-3px);background:rgba(255,255,255,0.02)}
.btn.primary{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-color:rgba(255,255,255,0.04)}

/* sections */
.section{padding:34px 0;border-top:1px solid rgba(255,255,255,0.02)}
.section .section-title{font-size:20px;text-align:center;color:var(--text);margin-bottom:12px}
.section p{color:var(--muted);text-align:center;max-width:900px;margin:0 auto 12px}

/* expertise / chips area */
.chips-wrap{max-width:920px;margin:18px auto;display:flex;flex-direction:column;gap:14px}
.chips-row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
.chip{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.03);padding:10px 14px;border-radius:10px;color:var(--muted);font-weight:700;display:inline-flex;align-items:center;gap:8px}

/* separator icon paw */
.sep-row{display:flex;align-items:center;gap:12px;justify-content:center;margin:18px 0}
.sep-row .line{height:1px;background:rgba(255,255,255,0.04);flex:1}
.sep-row .paw{width:46px;height:46px;border-radius:12px;background:var(--card);display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow);font-size:18px;color:var(--text)}

/* skills grid */
.skills-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px;max-width:980px;margin:8px auto 0}
.skill{padding:12px;border-radius:12px;background:var(--card);box-shadow:var(--shadow);transition:transform .24s ease}
.skill:hover{transform:translateY(-6px)}
.label{display:flex;justify-content:space-between;font-weight:800;color:var(--text);margin-bottom:8px}
.bar{height:12px;background:#0b0b0c;border-radius:999px;overflow:hidden;position:relative}
.fill{height:100%;width:0;background:linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.12));transition:width 1.6s cubic-bezier(.2,.9,.2,1);opacity:0}

/* projects / cards */
.card-grid{display:grid;gap:14px;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));max-width:980px;margin:12px auto 0}
.card{padding:14px;border-radius:12px;background:var(--card);box-shadow:var(--shadow);transition:transform .28s ease}
.card:hover{transform:translateY(-8px)}
.card h3{margin:0;color:var(--text)}
.card p{margin:0;color:var(--muted)}

/* experience list */
.experience{max-width:900px;margin:8px auto;background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow)}
.experience ul{list-style:inside disc;color:var(--muted);padding-left:18px}

/* contact */
.contact-card{max-width:760px;margin:8px auto;background:var(--card);padding:14px;border-radius:12px;box-shadow:var(--shadow);text-align:center}
.contact-card a{color:var(--text);text-decoration:none;font-weight:700}
.form{max-width:760px;margin:10px auto;display:flex;flex-direction:column;gap:10px}
.input,textarea{background:#0b0b0d;border:1px solid rgba(255,255,255,0.04);padding:10px;border-radius:8px;color:var(--text)}
.textarea{min-height:120px}

/* footer */
.footer{text-align:center;color:var(--muted);padding:28px 0}

/* modal panel */
.panel-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;z-index:995}
.panel-backdrop.show{display:flex}
.panel{width:min(540px,95%);padding:14px;border-radius:12px;background:var(--card);box-shadow:var(--shadow)}
.specs-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}

/* taskbar */
.taskbar{
  position:fixed;bottom:16px;left:50%;transform:translateX(-50%);height:var(--taskbar-h);
  display:flex;align-items:center;gap:8px;padding:8px;border-radius:18px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.12));
  z-index:1000;box-shadow:0 20px 60px rgba(0,0,0,0.6);
}
.taskbar.glass{backdrop-filter: blur(10px)}
.taskbtn{background:transparent;border:none;color:var(--text);padding:10px;border-radius:10px;cursor:pointer;display:flex;align-items:center;gap:8px;font-weight:800}
.taskbtn svg{width:18px;height:18px;display:block;fill:currentColor;opacity:0.95}
.taskbtn:hover{background:rgba(255,255,255,0.02);transform:translateY(-3px)}

/* mac-like menu */
.menu{
  position:absolute;min-width:220px;right:0;top:-240px;background:var(--card);border-radius:12px;padding:8px;box-shadow:0 18px 50px rgba(0,0,0,0.6);
  display:flex;flex-direction:column;gap:6px;transform-origin:top right;opacity:0;transform:translateY(-8px) scale(.98);transition:transform .22s cubic-bezier(.2,.9,.2,1), opacity .18s ease;
}
.menu.show{opacity:1;transform:translateY(6px) scale(1)}
.menu button{background:transparent;border:none;color:var(--text);padding:10px;border-radius:8px;text-align:left;cursor:pointer}
.menu button:hover{background:rgba(255,255,255,0.02)}

/* snow & particles canvas */
#canvas-layer{position:fixed;inset:0;pointer-events:none;z-index:15}

/* a11y */
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* responsive */
@media (max-width:720px){
  .nav{display:none}
  .avatar{width:120px;height:120px}
  .taskbar{left:12px;right:12px;transform:none;width:calc(100% - 24px)}
}
</style>
</head>
<body>

<!-- canvas layer for particles/snow -->
<canvas id="canvas-layer" aria-hidden="true"></canvas>

<header class="header">
  <div class="header-inner glass">
    <a class="brand" href="#">vjvc</a>
    <nav class="nav" aria-label="Main navigation">
      <a href="#about" data-scroll>About</a>
      <a href="#skills" data-scroll>Skills</a>
      <a href="#projects" data-scroll>Projects</a>
      <a href="#experience" data-scroll>Experience</a>
      <a href="#contact" data-scroll>Contact</a>
    </nav>
  </div>
</header>

<main class="container" id="main">
  <!-- hero -->
  <section class="hero" id="hero" aria-labelledby="hero-heading">
    <img class="avatar" src="https://i.postimg.cc/TYbRz0NG/Andrew-Graves.jpg" alt="Armin avatar" loading="lazy" />
    <div class="title" id="hero-heading">Armin ‚Äî Digital Artist</div>
    <div class="subtitle">Character designer, illustrator and digital painter. Over 4 years creating custom art for streamers, brands and communities.</div>
    <div class="cta">
      <button class="btn primary" data-scroll="#projects">Projects</button>
      <button class="btn" data-scroll="#contact">Contact</button>
    </div>
  </section>

  <!-- about -->
  <section class="section" id="about">
    <div class="section-title">About Me</div>
    <p class="section-text">I create stylized characters, illustrations and digital paintings. I focus on vibrant composition, expressive linework and clear storytelling through visuals.</p>
  </section>

  <!-- expertise -->
  <section class="section" id="expertise">
    <div class="section-title">My Expertise</div>
    <p class="section-text">Here's an overview of artistic tools, techniques, and the creative areas I focus on.</p>

    <div class="chips-wrap">
      <div class="glass" style="padding:16px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="display:flex;align-items:center;gap:12px">
            <div style="width:44px;height:44px;border-radius:10px;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;font-weight:800">üñå</div>
            <div>
              <div style="font-weight:800;color:var(--text)">Tools / Services</div>
              <div style="color:var(--muted);font-size:13px">Software and services I use</div>
            </div>
          </div>
        </div>

        <div style="margin-top:12px" class="chips-row" aria-hidden="false">
          <div class="chip">Photoshop</div>
          <div class="chip">Procreate</div>
          <div class="chip">Affinity Photo</div>
          <div class="chip">Clip Studio</div>
          <div class="chip">Artstation</div>
        </div>
      </div>

      <div class="sep-row" aria-hidden="true" style="align-items:center">
        <div class="line"></div>
        <div class="paw">üêæ</div>
        <div class="line"></div>
      </div>

      <div class="glass" style="padding:16px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div style="display:flex;align-items:center;gap:12px">
            <div style="width:44px;height:44px;border-radius:10px;background:rgba(255,255,255,0.02);display:flex;align-items:center;justify-content:center;font-weight:800">üíª</div>
            <div>
              <div style="font-weight:800;color:var(--text)">Languages / Techniques</div>
              <div style="color:var(--muted);font-size:13px">Approaches I often use</div>
            </div>
          </div>
        </div>

        <div style="margin-top:12px" class="chips-row">
          <div class="chip">Digital Painting</div>
          <div class="chip">Character Design</div>
          <div class="chip">Color Studies</div>
          <div class="chip">Composition</div>
          <div class="chip">Brushwork & Textures</div>
        </div>
      </div>
    </div>
  </section>

  <!-- skills -->
  <section class="section" id="skills">
    <div class="section-title">Artistic Skills</div>

    <div class="skills-grid" aria-live="polite">
      <div class="skill glass">
        <div class="label"><span>Illustration</span><span>95%</span></div>
        <div class="bar"><div class="fill" data-width="95"></div></div>
      </div>
      <div class="skill glass">
        <div class="label"><span>Character Design</span><span>90%</span></div>
        <div class="bar"><div class="fill" data-width="90"></div></div>
      </div>
      <div class="skill glass">
        <div class="label"><span>Digital Painting</span><span>88%</span></div>
        <div class="bar"><div class="fill" data-width="88"></div></div>
      </div>
      <div class="skill glass">
        <div class="label"><span>Concept Art</span><span>80%</span></div>
        <div class="bar"><div class="fill" data-width="80"></div></div>
      </div>
    </div>
  </section>

  <!-- projects -->
  <section class="section" id="projects">
    <div class="section-title">Projects</div>
    <div class="card-grid">
      <article class="card glass" tabindex="0">
        <h3>Character Portfolio</h3>
        <p class="meta">Stylized characters for games and comics</p>
        <p class="desc">A curated gallery of characters with costumes, expressions and color scripts.</p>
      </article>
      <article class="card glass" tabindex="0">
        <h3>Streamer Illustration Pack</h3>
        <p class="meta">Assets for streamers</p>
        <p class="desc">Avatar packs, emotes and stream overlays tailored for personal brands.</p>
      </article>
      <article class="card glass" tabindex="0">
        <h3>Digital Painting Series</h3>
        <p class="meta">Exhibition work</p>
        <p class="desc">Standalone paintings exploring stylized lighting and mood.</p>
      </article>
    </div>
  </section>

  <!-- experience -->
  <section class="section" id="experience">
    <div class="section-title">Artist Experience</div>
    <div class="experience glass">
      <ul>
        <li><strong>4 years</strong> professional experience in digital art</li>
        <li>Commissioned artworks for streamers and brands</li>
        <li>Exhibitions and collaborative art series</li>
        <li>Integration of artwork into UI/UX for creative apps</li>
      </ul>
    </div>
  </section>

  <!-- contact -->
  <section class="section" id="contact">
    <div class="section-title">Contact</div>
    <div class="contact-card glass">
      <p>For commissions or collaborations email: <a href="mailto:arminrhgozar@gmail.com">arminrhgozar@gmail.com</a></p>
      <p>Instagram: <a href="https://instagram.com" target="_blank">@armin.rhg</a></p>
      <p>Discord: <span class="mono">vjvc</span></p>
    </div>

    <form id="contact-form" class="form" aria-label="Contact form">
      <input class="input" type="text" name="name" placeholder="Your name" required>
      <input class="input" type="email" name="email" placeholder="Your email" required>
      <textarea class="input textarea" name="message" placeholder="Message..." required></textarea>
      <div style="text-align:center"><button class="btn primary" type="submit">Send Message</button></div>
    </form>
  </section>

  <footer class="footer">¬© <span id="year"></span> Armin ‚Äî vjvc</footer>
</main>

<!-- PC SPECS PANEL -->
<div class="panel-backdrop" id="panel-backdrop" aria-hidden="true">
  <div class="panel glass" role="dialog" aria-modal="true" aria-labelledby="panel-title">
    <h3 id="panel-title">System Specs</h3>
    <div class="specs-grid">
      <div><strong>CPU</strong><div>Ryzen 9 9300</div></div>
      <div><strong>GPU</strong><div>RTX 3080</div></div>
      <div><strong>Monitor</strong><div>MSI</div></div>
      <div><strong>Keyboard</strong><div>Red Dragon</div></div>
    </div>
    <div style="text-align:center;margin-top:12px">
      <button class="btn" id="close-panel">Close</button>
    </div>
  </div>
</div>

<!-- TASKBAR -->
<div class="taskbar glass" role="toolbar" aria-label="Taskbar">
  <div style="position:relative">
    <button class="taskbtn" id="btn-settings" aria-haspopup="true" aria-expanded="false" title="Settings">
      <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65a.5.5 0 0 0 .11-.64l-2-3.46a.5.5 0 0 0-.6-.22l-2.49 1a7.03 7.03 0 0 0-1.7-.98l-.38-2.65A.5.5 0 0 0 14 2h-4a.5.5 0 0 0-.5.42l-.38 2.65c-.63.24-1.21.57-1.7.98l-2.49-1a.5.5 0 0 0-.6.22l-2 3.46a.5.5 0 0 0 .11.64L4.57 11c-.04.32-.07.64-.07.98s.03.66.07.98l-2.11 1.65a.5.5 0 0 0-.11.64l2 3.46a.5.5 0 0 0 .6.22l2.49-1c.49.41 1.07.74 1.7.98l.38 2.65A.5.5 0 0 0 10 22h4a.5.5 0 0 0 .5-.42l.38-2.65c.63-.24 1.21-.57 1.7-.98l2.49 1a.5.5 0 0 0 .6-.22l2-3.46a.5.5 0 0 0-.11-.64L19.43 12.98z"/></svg>
    </button>
    <div class="menu" id="settings-menu" role="menu" aria-hidden="true">
      <button id="menu-snow" role="menuitem">Toggle Snow</button>
      <button id="menu-theme" role="menuitem">Toggle Light Theme</button>
      <button id="menu-close" role="menuitem">Close</button>
    </div>
  </div>

  <button class="taskbtn" id="btn-pcspec" title="PC Specs" aria-label="PC Specs">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M4 5h16a2 2 0 0 1 2 2v9H2V7a2 2 0 0 1 2-2zm7 14h2a2 2 0 1 1-2 0z"/></svg>
  </button>

  <button class="taskbtn" data-target="#projects" title="Projects" aria-label="Projects">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 7a2 2 0 0 1 2-2h4v2H5v3H3V7zm18 3h-2V7h-4V5h4a2 2 0 0 1 2 2v3zM3 14h2v3h4v2H5a2 2 0 0 1-2-2v-3zm16 3v-3h2v3a2 2 0 0 1-2 2h-4v-2h4z"/></svg>
  </button>

  <button class="taskbtn" data-target="#skills" title="Skills" aria-label="Skills">
    <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2l1.5 4.5H18l-3.75 2.75L15.5 14 12 11.5 8.5 14l1.25-4.75L6 6.5h4.5z"/></svg>
  </button>
</div>

<script>
/* =========================================================
   Final single-file JS
   - canvas snow + particles (optimized)
   - menu behavior
   - theme toggle & persistence
   - skill animations
   - smooth scroll & taskbar keyboard
   - accessibility (reduced motion)
   ========================================================= */

(function(){
  // helpers
  const q = sel => document.querySelector(sel);
  const qa = sel => Array.from(document.querySelectorAll(sel));
  const clamp = (v,a,b) => Math.max(a, Math.min(b, v));
  const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

  /* ---------------- theme ---------------- */
  let isLight = false;
  function setTheme(light, persist=true){
    isLight = !!light;
    if(isLight) document.body.classList.add('light'); else document.body.classList.remove('light');
    if(persist) try{ localStorage.setItem('vjvc-theme', isLight ? 'light' : 'dark'); }catch(e){}
    const menuTheme = q('#menu-theme');
    if(menuTheme) menuTheme.textContent = isLight ? 'Switch to Dark Theme' : 'Switch to Light Theme';
  }
  (function restoreTheme(){ try{ const t = localStorage.getItem('vjvc-theme'); if(t === 'light') setTheme(true,false); }catch(e){} })();

  /* ---------------- smooth scroll ---------------- */
  function smoothTo(el){
    if(!el) return;
    const header = q('.header-inner');
    const headerH = header ? header.offsetHeight + 8 : 0;
    const rect = el.getBoundingClientRect();
    const top = window.scrollY + rect.top - headerH;
    window.scrollTo({top, behavior: prefersReduce ? 'auto' : 'smooth'});
  }
  qa('[data-scroll]').forEach(a => {
    a.addEventListener('click', (e) => {
      e.preventDefault();
      const target = a.dataset.target || a.getAttribute('href');
      if(!target) return;
      const el = document.querySelector(target);
      smoothTo(el);
    });
  });
  qa('.taskbtn[data-target]').forEach(btn=>{
    btn.addEventListener('click', ()=> {
      const t = btn.getAttribute('data-target');
      if(t){ const el = document.querySelector(t); smoothTo(el); }
    });
  });

  /* ---------------- panels ---------------- */
  const panel = q('#panel-backdrop');
  q('#btn-pcspec')?.addEventListener('click', ()=> { if(panel){ panel.classList.add('show'); panel.setAttribute('aria-hidden','false'); }});
  q('#close-panel')?.addEventListener('click', ()=> { if(panel){ panel.classList.remove('show'); panel.setAttribute('aria-hidden','true'); }});
  panel?.addEventListener('click', (e)=> { if(e.target === panel){ panel.classList.remove('show'); panel.setAttribute('aria-hidden','true'); }});

  /* ---------------- contact form (demo) ---------------- */
  const contactForm = q('#contact-form');
  if(contactForm){
    contactForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      const btn = contactForm.querySelector('button[type="submit"]');
      if(btn){ btn.disabled=true; btn.textContent='Sending...'; }
      setTimeout(()=>{ alert('Your message has been sent (demo). I will reply soon.'); contactForm.reset(); if(btn){ btn.disabled=false; btn.textContent='Send Message'; } }, 900);
    });
  }

  /* ---------------- skills animation ---------------- */
  (function skills(){
    const sec = q('#skills');
    if(!sec) return;
    const fills = qa('.fill');
    fills.forEach(f=>{ f.style.width='0%'; f.style.opacity='0'; });
    const io = new IntersectionObserver((entries, obs)=>{
      entries.forEach(entry=>{
        if(entry.isIntersecting){
          fills.forEach((f, i)=> {
            const v = clamp(parseInt(f.dataset-width||f.dataset.width||f.getAttribute('data-width')||'0',10),0,100);
            setTimeout(()=>{ f.style.opacity='1'; f.style.width = v + '%'; }, prefersReduce ? 0 : i * 120);
          });
          obs.disconnect();
        }
      });
    }, { threshold: 0.28 });
    io.observe(sec);
  })();

  /* ===============================
     Canvas-based particles + snow
     - single canvas, drop-in objects, pooling
     - optimized spawn rules and simple physics
     =============================== */
  const canvas = q('#canvas-layer');
  const ctx = canvas.getContext && canvas.getContext('2d');
  let W = innerWidth, H = innerHeight;
  let rafId = null;
  // arrays
  const particles = []; // tiny ambient dots
  const flakes = []; // snow emoji-like (we'll draw circles resembling glyphs)
  const MAX_PARTICLES = prefersReduce ? 14 : 48;
  const MAX_FLAKES = prefersReduce ? 10 : 48;
  // init size
  function resize(){ W = canvas.width = innerWidth; H = canvas.height = innerHeight; }
  window.addEventListener('resize', resize);
  resize();

  function rand(min,max){ return Math.random()*(max-min)+min; }

  // spawn particle
  function spawnParticle(){
    if(particles.length >= MAX_PARTICLES) return;
    particles.push({
      x: rand(0, W), y: rand(-0.2*H, H), r: rand(1,6),
      vy: rand(0.02, 0.12), vx: rand(-0.02, 0.02),
      alpha: rand(0.03, 0.22), sway: rand(10,80), swaySpeed: rand(2000,8000), birth: performance.now()
    });
  }
  // spawn flake
  function spawnFlake(){
    if(flakes.length >= MAX_FLAKES) return;
    flakes.push({
      x: rand(-0.05*W, W + 0.05*W), y: rand(-0.3*H, -0.02*H),
      r: rand(6,22), vy: rand(0.02, 0.12), sway: rand(30,160), swaySpeed: rand(1500,8000), birth: performance.now(), alpha: rand(0.25,0.95)
    });
  }

  // update/draw
  let last = performance.now(), acc = 0;
  function step(now){
    const dt = Math.min(40, now - last); last = now;
    acc += dt;

    // spawn logic conservative
    if(!prefersReduce){
      if(Math.random() < 0.06) spawnParticle();
      if(acc > 160){ acc = 0; if(Math.random() < 0.9) spawnFlake(); }
    }

    // clear
    ctx.clearRect(0,0,W,H);

    // draw particles (ambient subtle circles)
    for(let i=particles.length-1;i>=0;i--){
      const p = particles[i];
      p.x += p.vx * dt;
      p.y += p.vy * dt;
      const age = now - p.birth;
      const sway = Math.sin((age / p.swaySpeed) * Math.PI*2) * p.sway * 0.5;
      const drawX = p.x + sway;
      ctx.beginPath();
      ctx.globalAlpha = p.alpha;
      ctx.fillStyle = '#ffffff';
      ctx.arc(drawX, p.y, p.r, 0, Math.PI*2);
      ctx.fill();
      if(p.y > H + 60 || p.x < -60 || p.x > W + 60) particles.splice(i,1);
    }

    // draw flakes (larger soft circles)
    for(let i=flakes.length-1;i>=0;i--){
      const f = flakes[i];
      f.y += f.vy * dt;
      const age = now - f.birth;
      const sway = Math.sin((age / f.swaySpeed) * Math.PI*2) * f.sway * 0.5;
      const drawX = f.x + sway;
      // soft circle with composite
      const g = ctx.createRadialGradient(drawX, f.y, f.r*0.1, drawX, f.y, f.r);
      ctx.globalAlpha = f.alpha;
      g.addColorStop(0, 'rgba(255,255,255,0.95)');
      g.addColorStop(0.6, 'rgba(255,255,255,0.18)');
      g.addColorStop(1, 'rgba(255,255,255,0.02)');
      ctx.fillStyle = g;
      ctx.beginPath();
      ctx.arc(drawX, f.y, f.r, 0, Math.PI*2);
      ctx.fill();
      if(f.y > H + 80) flakes.splice(i,1);
    }

    ctx.globalAlpha = 1;
    rafId = requestAnimationFrame(step);
  }

  // controllers
  let snowRunning = true;
  function startCanvas(){
    if(!ctx) return;
    if(!rafId) { last = performance.now(); rafId = requestAnimationFrame(step); }
  }
  function stopCanvas(){
    if(rafId){ cancelAnimationFrame(rafId); rafId = null; }
    particles.length = 0; flakes.length = 0; ctx.clearRect(0,0,W,H);
  }
  // init based on pref
  try{
    const s = localStorage.getItem('vjvc-snow');
    if(s === 'off'){ snowRunning = false; stopCanvas(); } else { snowRunning = true; startCanvas(); }
  }catch(e){ startCanvas(); }

  /* expose toggle */
  function toggleSnow(){
    snowRunning = !snowRunning;
    if(snowRunning){ startCanvas(); try{ localStorage.setItem('vjvc-snow','on'); }catch(e){} }
    else{ stopCanvas(); try{ localStorage.setItem('vjvc-snow','off'); }catch(e){} }
  }

  /* ---------------- settings menu logic ---------------- */
  const btnSettings = q('#btn-settings');
  const settingsMenu = q('#settings-menu');
  const menuSnow = q('#menu-snow');
  const menuTheme = q('#menu-theme');
  const menuClose = q('#menu-close');

  if(btnSettings){
    btnSettings.addEventListener('click', ()=>{
      const rect = btnSettings.getBoundingClientRect();
      const menu = settingsMenu;
      menu.style.right = (window.innerWidth - rect.right) + 'px';
      menu.style.top = (rect.top - 8) + 'px';
      const show = menu.classList.toggle('show');
      menu.setAttribute('aria-hidden', show ? 'false' : 'true');
      btnSettings.setAttribute('aria-expanded', show ? 'true' : 'false');
      if(menuTheme) menuTheme.textContent = isLight ? 'Switch to Dark Theme' : 'Switch to Light Theme';
      if(menuSnow) menuSnow.textContent = (rafId ? 'Disable Snow' : 'Enable Snow');
    });
  }
  menuSnow?.addEventListener('click', ()=> { toggleSnow(); settingsMenu.classList.remove('show'); });
  menuTheme?.addEventListener('click', ()=> { setTheme(!isLight); settingsMenu.classList.remove('show'); });
  menuClose?.addEventListener('click', ()=> settingsMenu.classList.remove('show'));

  // close settings when clicking outside
  document.addEventListener('click', (e)=>{
    if(!btnSettings) return;
    const menu = settingsMenu;
    if(menu && menu.classList.contains('show')){
      if(!menu.contains(e.target) && !btnSettings.contains(e.target)) menu.classList.remove('show');
    }
  });

  /* keyboard accessibility for taskbar */
  qa('.taskbtn').forEach(btn=>{
    btn.setAttribute('tabindex','0');
    btn.addEventListener('keydown', (e)=> { if(e.key === 'Enter' || e.key === ' ') btn.click(); });
  });

  /* menu keyboard escape */
  document.addEventListener('keydown', (e)=> { if(e.key === 'Escape'){ settingsMenu?.classList.remove('show'); panel?.classList.remove('show'); } });

  /* prevent selecting canvas flicks */
  document.addEventListener('pointerdown', (e)=> { if(e.target && e.target.classList && e.target.classList.contains('snowflake')) e.target.style.pointerEvents = 'none'; });

  /* ensure canvas runs on focus/visibility change */
  document.addEventListener('visibilitychange', ()=>{
    if(document.hidden){ stopCanvas(); } else { if(snowRunning) startCanvas(); }
  });

  // kick off if not reduced
  if(!prefersReduce && snowRunning) startCanvas();

  /* ---------------- save on unload ---------------- */
  window.addEventListener('unload', ()=> {
    try{ localStorage.setItem('vjvc-theme', isLight ? 'light' : 'dark'); localStorage.setItem('vjvc-snow', (rafId ? 'on' : 'off')); }catch(e){}
  });

  /* small safety for menu pos on resize */
  window.addEventListener('resize', ()=> {
    const menu = q('#settings-menu');
    if(menu && menu.classList.contains('show')){
      const rect = q('#btn-settings').getBoundingClientRect();
      menu.style.right = (window.innerWidth - rect.right) + 'px';
    }
  });

  /* set current year */
  (function setYear(){ const y = q('#year'); if(y) y.textContent = new Date().getFullYear(); })();

})();
</script>
</body>
</html>
